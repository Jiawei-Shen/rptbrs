(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@d3fc/d3fc-rebind"),require("d3-scale"),require("d3-shape")):"function"==typeof define&&define.amd?define(["exports","@d3fc/d3fc-rebind","d3-scale","d3-shape"],t):(e="undefined"==typeof globalThis?e||self:globalThis,t(e.fc=e.fc||{},e.fc,e.d3,e.d3))})(this,function(e,t,a,i){'use strict';var n=Math.abs;function o(e){switch(e){case X.BYTE:case X.UNSIGNED_BYTE:return 1;case X.SHORT:case X.UNSIGNED_SHORT:return 2;case X.FLOAT:return 4;default:throw new Error("Unknown type ".concat(e));}}function r(e){switch(e){case X.BYTE:return Int8Array;case X.UNSIGNED_BYTE:return Uint8Array;case X.SHORT:return Int16Array;case X.UNSIGNED_SHORT:return Uint16Array;case X.FLOAT:return Float32Array;default:throw new Error("Unknown type ".concat(e));}}var l=function(){var e=[0,1],t=[-1,1],a=function(){};return a.domain=function(){return arguments.length?(e=0>=arguments.length?void 0:arguments[0],a):e},a.range=function(){return arguments.length?(t=0>=arguments.length?void 0:arguments[0],a):t},a},d=function(){var e={},t={},a=null,i=function(i,o){var r=i.context();Object.keys(e).forEach(function(t){var a=e[t];if("function"!=typeof a)throw new Error("Expected an attribute for ".concat(t,", found ").concat(a));var n=r.getAttribLocation(o,t);a.location(n)(i)}),Object.keys(t).forEach(function(e){var a=t[e];if("function"!=typeof a)throw new Error("Expected a uniform for ".concat(e,", found ").concat(a));var n=r.getUniformLocation(o,e);a.location(n)(i)}),null!==a&&a(i)};return i.flush=function(){Object.values(e).forEach(function(e){return e.clear()}),Object.values(t).forEach(function(e){return e.clear()}),null!==a&&a.clear()},i.attribute=function(){for(var t=arguments.length,a=Array(t),o=0;o<t;o++)a[o]=arguments[o];return 1===a.length?e[a[0]]:(e[a[0]]=a[1],i)},i.uniform=function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];return 1===a.length?t[a[0]]:(t[a[0]]=a[1],i)},i.elementIndices=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],i):a},i},f=function(e){var t=-1,a=e,i=!0,o=function(e){if(i){var o=e.context();if(Array.isArray(a))switch(a.length){case 1:o.uniform1fv(t,a);break;case 2:o.uniform2fv(t,a);break;case 3:o.uniform3fv(t,a);break;case 4:o.uniform4fv(t,a);break;default:throw new Error("Uniform supports up to 4 elements. ".concat(a.length," provided."));}else o.uniform1f(t,a);i=!1}};return o.clear=function(){i=!0},o.location=function(){return arguments.length?(t!==(0>=arguments.length?void 0:arguments[0])&&(t=0>=arguments.length?void 0:arguments[0],i=!0),o):t},o.data=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],i=!0,o):a},o},s={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},u=function(){function e(e,t,a){return!e||p||t!==l||a!==u}function t(e,t){var o=a(e,i.VERTEX_SHADER),r=a(t,i.FRAGMENT_SHADER),n=i.createProgram();if(i.attachShader(n,o),i.attachShader(n,r),i.linkProgram(n),h&&!i.getProgramParameter(n,i.LINK_STATUS)){var l=i.getProgramInfoLog(n);throw i.deleteProgram(n),new Error("Failed to link program : ".concat(l,"\n            Vertex Shader : ").concat(e,"\n            Fragment Shader : ").concat(t))}return n}function a(e,t){var a=i.createShader(t);if(i.shaderSource(a,e),i.compileShader(a),h&&!i.getShaderParameter(a,i.COMPILE_STATUS)){var o=i.getShaderInfoLog(a);throw i.deleteShader(a),new Error("Failed to compile shader : ".concat(o,"\n            Shader : ").concat(e))}return a}var i=null,o=null,r=null,n=null,l=null,u=null,c=s.TRIANGLES,b=0,g=d(),h=!1,v=null,p=!0,y=1,S=function a(d){if(null!=i){var s=r(),h=n();if(e(o,s,h)&&(o=t(s,h),l=s,u=h,p=!1),i.useProgram(o),g.uniform("uScreen",f([i.canvas.width/y,i.canvas.height/y])),g(a,o),0===b)null==g.elementIndices()?i.drawArrays(c,0,d):i.drawElements(c,d,i.UNSIGNED_SHORT,0);else if(null==g.elementIndices())v.drawArraysInstancedANGLE(c,0,b,d);else{var S=g.elementIndices().data().length;if(b!==S)throw new Error("Expected elementIndices length ".concat(S)+" to match subInstanceCount ".concat(b,"."));v.drawElementsInstancedANGLE(c,b,i.UNSIGNED_SHORT,0,d)}}};return S.extInstancedArrays=function(){return v},S.context=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.length?((null==t[0]||t[0]!==i)&&(g.flush(),p=!0),null!=t[0]&&t[0]!==i&&(v=t[0].getExtension("ANGLE_instanced_arrays")),i=t[0],S):i},S.buffers=function(){return arguments.length?(g=0>=arguments.length?void 0:arguments[0],S):g},S.vertexShader=function(){return arguments.length?(r=0>=arguments.length?void 0:arguments[0],S):r},S.fragmentShader=function(){return arguments.length?(n=0>=arguments.length?void 0:arguments[0],S):n},S.mode=function(){return arguments.length?(c=0>=arguments.length?void 0:arguments[0],S):c},S.subInstanceCount=function(){return arguments.length?(b=0>=arguments.length?void 0:arguments[0],S):b},S.debug=function(){return arguments.length?(h=0>=arguments.length?void 0:arguments[0],S):h},S.pixelRatio=function(){return arguments.length?(y=0>=arguments.length?void 0:arguments[0],S):y},S},c=function(e){function t(e,t){e.push(t)}function a(e,t,a){var i=e.indexOf(a);e.splice(0<=i?i:e.length,0,t)}function i(e,t){var a=e.indexOf(t);-1===a&&e.push(t)}var o=[],r=[],n=function(){return e(o.join("\n"),r.join("\n"))};return n.appendHeader=function(e){return t(o,e),n},n.insertHeader=function(e,t){return a(o,e,t),n},n.appendHeaderIfNotExists=function(e){return i(o,e),n},n.appendBody=function(e){return t(r,e),n},n.insertBody=function(e,t){return a(r,e,t),n},n.appendBodyIfNotExists=function(e){return i(r,e),n},n},b=function(e,t){return"\nprecision mediump float;\nfloat inf = 1.0 / 0.0;\n".concat(e,"\nvoid main() {\n    ").concat(t,"\n}")},g=function(e,t){return"\nprecision mediump float;\n".concat(e,"\nvoid main() {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n    ").concat(t,"\n}")},h={header:"attribute vec4 aFillColor;\n             varying vec4 vFillColor;",body:"vFillColor = aFillColor;"},v={header:"attribute vec4 aStrokeColor;\n             varying vec4 vStrokeColor;",body:"vStrokeColor = aStrokeColor;"},p={header:"\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aSize;\n        attribute float aDefined;\n\n        uniform float uStrokeWidth;\n\n        varying float vSize;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vSize = 2.0 * sqrt(aSize / 3.14159);\n        gl_PointSize = vSize + uStrokeWidth + 1.0;\n        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);"},y={header:"\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aSize;\n        attribute float aDefined;\n\n        uniform float uStrokeWidth;\n\n        varying float vSize;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vSize = 4.0 * sqrt(aSize / 3.14159);\n        gl_PointSize = vSize + uStrokeWidth + 1.0;\n        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);"},S={header:"\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aSize;\n        attribute float aDefined;\n\n        uniform float uStrokeWidth;\n\n        varying float vSize;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vSize = 3.0 * sqrt(aSize / 3.14159);\n        gl_PointSize = vSize + uStrokeWidth + 1.0;\n        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);"},x={header:"\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aSize;\n        attribute float aDefined;\n\n        uniform float uStrokeWidth;\n\n        varying float vSize;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vSize = sqrt(aSize);\n        gl_PointSize = vSize + uStrokeWidth + 1.0;\n        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);"},m={header:"\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aSize;\n        attribute float aDefined;\n\n        uniform float uStrokeWidth;\n\n        varying float vSize;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vSize = sqrt(aSize);\n        gl_PointSize = 2.0 * (vSize + uStrokeWidth + 1.0);\n        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);"},V={header:"\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aSize;\n        attribute float aDefined;\n\n        uniform float uStrokeWidth;\n\n        varying float vSize;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vSize = sqrt((16.0 * aSize) / (3.0 * sqrt(3.0)));\n        gl_PointSize = vSize + uStrokeWidth + 1.0;\n        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);"},C={header:"\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aSize;\n        attribute float aDefined;\n\n        uniform float uStrokeWidth;\n\n        varying float vSize;\n        varying float vStrokeWidthRatio;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vSize = 3.0 * sqrt(aSize / 5.0);\n        vStrokeWidthRatio = uStrokeWidth / (vSize + uStrokeWidth + 1.0);\n        gl_PointSize = vSize + uStrokeWidth + 1.0;\n        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);"},E={header:"\n        attribute float aCrossValue;\n        attribute float aBandwidth;\n        attribute float aHighValue;\n        attribute float aOpenValue;\n        attribute float aCloseValue;\n        attribute float aLowValue;\n        attribute vec3 aCorner;\n        attribute float aDefined;\n\n        uniform vec2 uScreen;\n        uniform float uStrokeWidth;\n\n        varying float vColorIndicator;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vColorIndicator = sign(aCloseValue - aOpenValue);\n\n        float isPositiveY = (sign(aCorner.y) + 1.0) / 2.0;\n        float isNotPositiveY = 1.0 - isPositiveY;\n        float isExtremeY = abs(aCorner.y) - 1.0;\n        float isNotExtremeY = 1.0 - isExtremeY;\n        float yValue =\n         (isPositiveY * isExtremeY * aLowValue) +\n         (isPositiveY * isNotExtremeY * aCloseValue) +\n         (isNotPositiveY * isNotExtremeY * aOpenValue) +\n         (isNotPositiveY * isExtremeY * aHighValue);\n\n        float lineWidthXDirection = (isNotExtremeY * aCorner.x) + (isExtremeY * aCorner.z);\n        float lineWidthYDirection = isNotExtremeY * sign(aCloseValue - aOpenValue) * aCorner.y;\n\n        float bandwidthModifier = aBandwidth * aCorner.x / 2.0;\n\n        float xModifier = (uStrokeWidth * lineWidthXDirection / 2.0) + bandwidthModifier;\n        float yModifier = uStrokeWidth * lineWidthYDirection / 2.0;\n\n        gl_Position = vec4(aCrossValue, yValue, 0, 1);"},D={header:"\n        attribute float aCrossValue;\n        attribute float aBandwidth;\n        attribute float aHighValue;\n        attribute float aOpenValue;\n        attribute float aCloseValue;\n        attribute float aLowValue;\n        attribute vec3 aCorner;\n        attribute float aDefined;\n\n        uniform vec2 uScreen;\n        uniform float uStrokeWidth;\n\n        varying float vColorIndicator;\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        vColorIndicator = sign(aCloseValue - aOpenValue);\n\n        float isPositiveY = (sign(aCorner.y) + 1.0) / 2.0;\n        float isNotPositiveY = 1.0 - isPositiveY;\n        float isExtremeY = abs(aCorner.y) - 1.0;\n        float isNotExtremeY = 1.0 - isExtremeY;\n        float yValue =\n            (isPositiveY * isExtremeY * aLowValue) +\n            (isPositiveY * isNotExtremeY * aCloseValue) +\n            (isNotPositiveY * isNotExtremeY * aOpenValue) +\n            (isNotPositiveY * isExtremeY * aHighValue);\n\n        float lineWidthXDirection = isExtremeY * aCorner.z;\n        float lineWidthYDirection = isNotExtremeY * aCorner.z;\n\n        float bandwidthModifier = isNotExtremeY * aCorner.x * aBandwidth / 2.0;\n\n        float xModifier = (uStrokeWidth * lineWidthXDirection / 2.0) + bandwidthModifier;\n        float yModifier = uStrokeWidth * lineWidthYDirection / 2.0;\n\n        gl_Position = vec4(aCrossValue, yValue, 0, 1);"},N={header:"\n        attribute float aCrossValue;\n        attribute float aBandwidth;\n        attribute float aMainValue;\n        attribute float aBaseValue;\n        attribute vec2 aCorner;\n        attribute float aDefined;\n\n        uniform vec2 uScreen;\n        uniform float uStrokeWidth;\n\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        float isBaseline = (1.0 - aCorner.y) / 2.0;\n        float yValue = (isBaseline * aBaseValue) + ((1.0 - isBaseline) * aMainValue);\n\n        float xModifier = aCorner.x * (aBandwidth) / 2.0;\n\n        gl_Position = vec4(aCrossValue, yValue, 0, 1);"},A={header:"\n        attribute vec3 aCorner;\n        attribute float aCrossValue;\n        attribute float aBandwidth;\n        attribute float aHighValue;\n        attribute float aLowValue;\n        attribute float aDefined;\n\n        uniform vec2 uScreen;\n        uniform float uStrokeWidth;\n\n        varying float vDefined;",body:"\n        vDefined = aDefined;\n        float isLow = (aCorner.y + 1.0) / 2.0;\n        float yValue = isLow * aLowValue + (1.0 - isLow) * aHighValue;\n\n        float isEdgeCorner = abs(aCorner.x);\n        float lineWidthXDirection = (1.0 - isEdgeCorner) * aCorner.z;\n        float lineWidthYDirection = isEdgeCorner * aCorner.z;\n\n        gl_Position = vec4(aCrossValue, yValue, 0, 1);\n\n        float xModifier = (uStrokeWidth * lineWidthXDirection) + (aBandwidth * aCorner.x / 2.0);\n        float yModifier = (uStrokeWidth * lineWidthYDirection);"},B={header:"\n        attribute vec3 aCorner;\n        attribute float aCrossValue;\n        attribute float aMainValue;\n        attribute float aCrossNextValue;\n        attribute float aMainNextValue;\n        attribute float aBaseValue;\n        attribute float aBaseNextValue;\n        attribute float aDefined;\n        attribute float aDefinedNext;\n\n        varying float vDefined;\n\n        float when_lt(float a, float b) {\n            return max(sign(b - a), 0.0);\n        }\n\n        float and(float a, float b) {\n            return a * b;\n        }",body:"\n        vDefined = aDefined * aDefinedNext;\n        gl_Position = vec4(0, 0, 0, 1);\n\n        float hasIntercepted = when_lt((aMainNextValue - aBaseNextValue) * (aMainValue - aBaseValue), 0.0);\n        float useIntercept = and(aCorner.z, hasIntercepted);\n\n        float yGradient = (aMainNextValue - aMainValue) / (aCrossNextValue - aCrossValue);\n        float yConstant = aMainNextValue - (yGradient * aCrossNextValue);\n\n        float y0Gradient = (aBaseNextValue - aBaseValue) / (aCrossNextValue - aCrossValue);\n        float y0Constant = aBaseNextValue - (y0Gradient * aCrossNextValue);\n\n        float denominator = (yGradient - y0Gradient) + step(abs(yGradient - y0Gradient), 0.0);\n        float interceptXValue = (y0Constant - yConstant) / denominator;\n        float interceptYValue = (yGradient * interceptXValue) + yConstant;\n\n        gl_Position = vec4(interceptXValue * useIntercept, interceptYValue * useIntercept, 0, 1);\n\n        gl_Position.x += (1.0 - useIntercept) * ((aCorner.x * aCrossNextValue) + ((1.0 - aCorner.x) * aCrossValue));\n        gl_Position.y += (1.0 - useIntercept) * (1.0 - aCorner.y) * ((aCorner.x * aMainNextValue) + ((1.0 - aCorner.x) * aMainValue));\n        gl_Position.y += (1.0 - useIntercept) * aCorner.y * ((aCorner.x * aBaseNextValue) + ((1.0 - aCorner.x) * aBaseValue));"},_={header:"\n        attribute vec4 aCorner;\n        attribute float aCrossValue;\n        attribute float aBandwidth;\n        attribute float aCapWidth;\n        attribute float aHighValue;\n        attribute float aUpperQuartileValue;\n        attribute float aMedianValue;\n        attribute float aLowerQuartileValue;\n        attribute float aLowValue;\n        attribute float aDefined;\n\n        uniform vec2 uScreen;\n        uniform float uStrokeWidth;\n\n        varying float vDefined;\n    ",body:"\n        vDefined = aDefined;\n        float isExtremeY = sign(abs(aCorner.y) - 2.0) + 1.0;\n        float isNotExtremeY = 1.0 - isExtremeY;\n\n        float isNonZeroY = abs(sign(aCorner.y));\n        float isZeroY = 1.0 - isNonZeroY;\n\n        float isQuartileY = isNotExtremeY * isNonZeroY;\n\n        float isPositiveY = (sign(aCorner.y + 0.5) + 1.0) / 2.0;\n        float isNegativeY = 1.0 - isPositiveY;\n\n        float yValue =\n          (isExtremeY * isNegativeY) * aHighValue +\n          (isQuartileY * isNegativeY) * aUpperQuartileValue +\n          isZeroY * aMedianValue +\n          (isQuartileY * isPositiveY) * aLowerQuartileValue +\n          (isExtremeY * isPositiveY) * aLowValue;\n\n        gl_Position = vec4(aCrossValue, yValue, 0, 1);\n\n        float isHorizontal = aCorner.w;\n        float isVertical = 1.0 - isHorizontal;\n\n        float xDisplacement = aCorner.x * (isExtremeY * aCapWidth + isNotExtremeY * aBandwidth) / 2.0;\n\n        float xModifier = (isVertical * uStrokeWidth * aCorner.z / 2.0) + xDisplacement;\n        float yModifier = isHorizontal * uStrokeWidth * aCorner.z / 2.0;"},z={header:"\n        varying float vSize;\n        varying float vDefined;",body:"\n        float canFill = 1.0;\n        float distance = length(2.0 * gl_PointCoord - 1.0);\n        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);\n        if (distance > 1.0 || vDefined < 0.5) {\n            discard;\n            return;\n        }"},I={header:"\n        varying float vSize;\n        varying float vDefined;\n\n        // anterior, exterior angles\n        float an = 0.628319;\n        vec2 acs = vec2(0.809017, 0.587786); // (cos, sin)\n        float en = 0.952000;\n        vec2 ecs = vec2(0.580055, 0.814577);\n    ",body:"\n        float canFill = 1.0;\n\n        vec2 p = 2.0 * gl_PointCoord - 1.0;\n        p.y *= -1.0;\n\n        // sector\n        float bn = mod(atan(p.x, p.y), 2.0 * an) - an;\n        p = length(p) * vec2(cos(bn), abs(sin(bn)));\n\n        p -= acs;\n        p += ecs * clamp(-dot(p, ecs), 0.0, acs.y / ecs.y);\n        float d = length(p) * sign(p.x);\n\n        float distance = 1.0 + d;\n        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);\n        if (distance > 1.0 || vDefined < 0.5) {\n            discard;\n            return;\n        }"},P={header:"\n        varying float vSize;\n        varying float vDefined;\n    ",body:"\n        float canFill = 1.0;\n\n        vec2 p = 2.0 * gl_PointCoord - 1.0;\n        p.y *= -1.0;\n\n        // sector\n        float an = 3.141593 / 3.0;\n        float bn = mod(atan(p.x, p.y), 2.0 * an) - an;\n        p = length(p) * vec2(cos(bn), abs(sin(bn)));\n\n        // box\n        vec2 d = abs(p) - vec2(0.9, 0.35);\n        float sdf = length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n\n        float distance = 1.0 + sdf;\n        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);\n        if (distance > 1.0 || vDefined < 0.5) {\n            discard;\n            return;\n        }"},w={header:"\n        varying float vSize;\n        varying float vDefined;",body:"\n        float canFill = 1.0;\n        if (vDefined < 0.5) {\n            discard;\n        }\n        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;\n        float distance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));\n        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);"},Y={header:"\n        varying float vSize;\n        varying float vDefined;\n        float a = 0.6;\n        float b = 1.0;\n    ",body:"\n        if (vDefined < 0.5) {\n            discard;\n        }\n\n        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;\n\n        float x = abs(pointCoordTransform.x);\n        float y = abs(pointCoordTransform.y);\n\n        float X = (a * b * x) / (a * y + b * x);\n        float Y = (a * b * y) / (a * y + b * x);\n\n        float distance = length(vec2(x, y)) / length(vec2(X, Y));\n\n        if (distance > 1.0) {\n            discard;\n        }\n    "},k={header:"\n        varying float vSize;\n        varying float vDefined;",body:"\n        float canFill = 1.0;\n        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;\n        float topEdgesDistance = abs(pointCoordTransform.x) - ((pointCoordTransform.y - 0.6) / sqrt(3.0));\n        float bottomEdgeDistance = pointCoordTransform.y + 0.5;\n        float distance = max(topEdgesDistance, bottomEdgeDistance);\n        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);\n        if (distance > 1.0 || vDefined < 0.5) {\n            discard;\n        }"},H={header:"\n        varying float vSize;\n        varying float vStrokeWidthRatio;\n        varying float vDefined;",body:"\n        float canFill = 1.0;\n        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;\n        float innerCornerDistance = min(abs(pointCoordTransform.x), abs(pointCoordTransform.y)) + 0.66 - vStrokeWidthRatio;\n        float outerEdgeDistance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));\n        float distance = max(innerCornerDistance, outerEdgeDistance);\n        float canStroke = smoothstep(vSize - 2.0, vSize, distance * vSize);\n        if (distance > 1.0 || vDefined < 0.5) {\n            discard;\n        }"},T={header:"\n        varying float vColorIndicator;\n        varying float vDefined;",body:"\n        float canFill = 1.0;\n        float canStroke = 0.0;\n        if (vDefined < 0.5) {\n            discard;\n        }\n        gl_FragColor = vec4(0.4, 0.8, 0, 1);\n        if (vColorIndicator < 0.0) {\n            gl_FragColor = vec4(0.8, 0.4, 0, 1);\n        }"},M={header:"\n        varying float vColorIndicator;\n        varying float vDefined;",body:"\n        float canFill = 0.0;\n        float canStroke = 1.0;\n        if (vDefined < 0.5) {\n            discard;\n        }\n        gl_FragColor = vec4(0.4, 0.8, 0, 1);\n        if (vColorIndicator < 0.0) {\n            gl_FragColor = vec4(0.8, 0.4, 0, 1);\n        }"},R={header:"\n        varying float vDefined;",body:"\n        float canFill = 1.0;\n        float canStroke = 0.0;\n        if (vDefined < 0.5) {\n            discard;\n        }\n        gl_FragColor = vec4(0.86, 0.86, 0.86, 1);"},W={header:"\n        varying float vDefined;\n    ",body:"\n        float canFill = 0.0;\n        float canStroke = 1.0;\n\n        if (vDefined < 0.5) {\n            discard;\n        }"},F={header:"varying float vDefined;",body:"\n        float canFill = 0.0;\n        float canStroke = 1.0;\n        if (vDefined < 0.5) {\n            discard;\n        }"},L={header:"varying float vDefined;",body:"\n        float canFill = 1.0;\n        float canStroke = 0.0;\n\n        gl_FragColor = vec4(0.60, 0.60, 0.60, 1.0);\n\n        if (vDefined < 0.5) {\n            discard;\n        }"},O={header:"varying vec4 vFillColor;",body:"gl_FragColor = (canFill * vFillColor) + ((1.0 - canFill) * gl_FragColor);"},G={header:"varying vec4 vStrokeColor;",body:"gl_FragColor = (canStroke * vStrokeColor) + ((1.0 - canStroke) * gl_FragColor);"},U=function(){var e=c(b),t=c(g);return e.appendHeader(B.header).appendBody(B.body),t.appendHeader(R.header).appendBody(R.body),{vertex:function(){return e},fragment:function(){return t}}},X={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,FLOAT:5126},Q=function(){var e=-1,t=null,a=1,i=X.FLOAT,o=!1,r=0,n=0,l=null,d=function(d){var f=d.context();null==t&&(t=f.createBuffer()),f.bindBuffer(f.ARRAY_BUFFER,t),f.vertexAttribPointer(e,a,i,o,r,n),f.enableVertexAttribArray(e);var s=d.extInstancedArrays();s.vertexAttribDivisorANGLE(e,null==l?0<d.subInstanceCount()?1:0:l)};return d.location=function(){return arguments.length?(e=0>=arguments.length?void 0:arguments[0],d):e},d.buffer=function(){return arguments.length?(t=0>=arguments.length?void 0:arguments[0],d):t},d.size=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],d):a},d.type=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],d):i},d.normalized=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],d):o},d.stride=function(){return arguments.length?(r=0>=arguments.length?void 0:arguments[0],d):r},d.offset=function(){return arguments.length?(n=0>=arguments.length?void 0:arguments[0],d):n},d.divisor=function(){return arguments.length?(l=0>=arguments.length?void 0:arguments[0],d):l},d},q=function(){var e=X.FLOAT,t=new Float32Array(0),a=function(a){var i=r(e);return t.length>a?t=new i(t.buffer,0,a):t.length!==a&&(t=new i(a)),t};return a.type=function(){if(!arguments.length)return e;if(e!==(0>=arguments.length?void 0:arguments[0])){e=0>=arguments.length?void 0:arguments[0];var i=r(e);t=new i(0)}return a},a},Z=function(){var e=!0,t=1,a=X.FLOAT,o=q(),r=function(e){return e},n=null,l=function(){var l=n.length,d=o.type(a)(l*t);if(1<t)for(var f,s=0;s<l;s++){if(f=r(n[s],s),f.length!==t)throw new Error("Expected components array of size ".concat(t,", recieved array with length ").concat(f.length,"."));for(var u=0;u<t;u++)d[s*t+u]=f[u]}else for(var c,b=0;b<l;b++){if(c=r(n[b],b),Array.isArray(c))throw new Error("Expected a single component value, recieved array with length ".concat(c.length,"."));d[b]=c}return e=!1,d};return l.dirty=function(){return e},l.clear=function(){e=!0},l.size=function(){return arguments.length?(t=0>=arguments.length?void 0:arguments[0],e=!0,l):t},l.type=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],e=!0,l):a},l.arrayViewFactory=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],e=!0,l):o},l.value=function(){return arguments.length?(r=0>=arguments.length?void 0:arguments[0],e=!0,l):r},l.data=function(){return arguments.length?(n=0>=arguments.length?void 0:arguments[0],e=!0,l):n},l},j=function(){var e=Q(),a=Z(),i=function t(i){if(e.size(t.size()).type(t.type()),e(i),!!a.dirty()){var o=a(),r=i.context();r.bindBuffer(r.ARRAY_BUFFER,e.buffer()),r.bufferData(r.ARRAY_BUFFER,o,r.DYNAMIC_DRAW)}};return i.clear=function(){e.buffer(null),a.clear()},t.rebind(i,e,"normalized","location","divisor"),t.rebind(i,a,"data","value","size","type"),i},K=function(e,t,a,i){for(var o=arguments.length,r=Array(4<o?o-4:0),n=4;n<o;n++)r[n-4]=arguments[n];e[t]=function(){for(var t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];var l=a[i].apply(a,r.concat(o));return l===a?e:l}},J=function(){var e=c(b),t=c(g);return e.appendHeader(p.header).appendBody(p.body),t.appendHeader(z.header).appendBody(z.body),{vertex:function(){return e},fragment:function(){return t}}},$=function(){var e=1,t=function(t){t.buffers().uniform("uStrokeWidth",f(e))};return t.lineWidth=function(){return arguments.length?(e=0>=arguments.length?void 0:arguments[0],t):e},t},ee=function(e){var t=null,a=e,i=!0,o=function(e){var o=e.context();null==t&&(t=o.createBuffer()),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),i&&(o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),o.STATIC_DRAW),i=!1)};return o.clear=function(){t=null,i=!0},o.data=function(){return arguments.length?(i=!0,a=0>=arguments.length?void 0:arguments[0],o):a},o},te=function(){var e=c(b),t=c(g);return e.appendHeader(D.header).appendBody(D.body),t.appendHeader(M.header).appendBody(M.body),{vertex:function(){return e},fragment:function(){return t}}},ae=function(){var e=c(b),t=c(g);return e.appendHeader(N.header).appendBody(N.body),t.appendHeader(L.header).appendBody(L.body),{vertex:function(){return e},fragment:function(){return t}}},ie=function(){var e=c(b),t=c(g);return e.appendHeader(A.header).appendBody(A.body),t.appendHeader(F.header).appendBody(F.body),{vertex:function(){return e},fragment:function(){return t}}},oe=function(){var e=c(b),t=c(g);return e.appendHeader(E.header).appendBody(E.body),t.appendHeader(T.header).appendBody(T.body),{vertex:function(){return e},fragment:function(){return t}}},re=function(){var e=c(b),t=c(g);return e.appendHeader(_.header).appendBody(_.body),t.appendHeader(W.header).appendBody(W.body),{vertex:function(){return e},fragment:function(){return t}}},ne=function(){var e=l(),a=function(e){return"linear".concat(e)},i=function t(i,o,r){i.vertexShader().appendHeaderIfNotExists("uniform vec4 ".concat(a(r),"Offset;")).appendHeaderIfNotExists("uniform vec4 ".concat(a(r),"Scale;")).appendBody("".concat(o," = ").concat(o," + ").concat(a(r),"Offset;")).appendBody("".concat(o," = ").concat(o," * ").concat(a(r),"Scale;"));var n=e.domain()[1]-e.domain()[0],l=e.range()[1]-e.range()[0],d=e.range()[0]*(n/l)-e.domain()[0],s=[0,0,0,0],t=[1,1,1,1];s[r]=d,t[r]=l/n,i.buffers().uniform("".concat(a(r),"Offset"),f(s)).uniform("".concat(a(r),"Scale"),f(t))};return t.rebindAll(i,e),i},le=function(){function e(e,t){var a=Math.log10;return a(e)/a(t)}var a=l(),i=10,o=function(e){return"log".concat(e)},r=function t(r,n,l){var d="".concat(o(l),"Offset + (").concat(o(l),"Scale * clamp(log(").concat(n,") / log(").concat(o(l),"Base), -inf, inf))");r.vertexShader().appendHeaderIfNotExists("uniform vec4 ".concat(o(l),"Offset;")).appendHeaderIfNotExists("uniform vec4 ".concat(o(l),"Scale;")).appendHeaderIfNotExists("uniform vec4 ".concat(o(l),"Include;")).appendHeaderIfNotExists("uniform float ".concat(o(l),"Base;")).appendBody("".concat(n," = (").concat(o(l),"Include * (").concat(d,")) + ((1.0 - ").concat(o(l),"Include) * ").concat(n,");"));var s=e(a.domain()[1],i)-e(a.domain()[0],i),u=a.range()[1]-a.range()[0],c=u/s,b=a.range()[0]-c*e(a.domain()[0],i),g=[0,0,0,0],t=[0,0,0,0],h=[0,0,0,0];g[l]=b,t[l]=c,h[l]=1,r.buffers().uniform("".concat(o(l),"Offset"),f(g)).uniform("".concat(o(l),"Scale"),f(t)).uniform("".concat(o(l),"Include"),f(h)).uniform("".concat(o(l),"Base"),f(i))};return r.base=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],r):i},t.rebindAll(r,a),r},de=function(){function e(t,a){var e=Math.pow,i=Math.sign;return i(t)*e(n(t),a)}var a=l(),i=1,o=function(e){return"pow".concat(e)},r=function t(r,n,l){var d="".concat(o(l),"Offset + (").concat(o(l),"Scale * sign(").concat(n,") * pow(abs(").concat(n,"), vec4(").concat(o(l),"Exp)))");r.vertexShader().appendHeaderIfNotExists("uniform vec4 ".concat(o(l),"Offset;")).appendHeaderIfNotExists("uniform vec4 ".concat(o(l),"Scale;")).appendHeaderIfNotExists("uniform vec4 ".concat(o(l),"Include;")).appendHeaderIfNotExists("uniform float ".concat(o(l),"Exp;")).appendBody("".concat(n," = (").concat(o(l),"Include * (").concat(d,")) + ((1.0 - ").concat(o(l),"Include) * ").concat(n,");"));var s=e(a.domain()[1],i)-e(a.domain()[0],i),u=a.range()[1]-a.range()[0],c=u/s,b=a.range()[0]-c*e(a.domain()[0],i),g=[0,0,0,0],t=[0,0,0,0],h=[0,0,0,0];g[l]=b,t[l]=c,h[l]=1,r.buffers().uniform("".concat(o(l),"Offset"),f(g)).uniform("".concat(o(l),"Scale"),f(t)).uniform("".concat(o(l),"Include"),f(h)).uniform("".concat(o(l),"Exp"),f(i))};return r.exponent=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],r):i},t.rebindAll(r,a),r},fe=a.scaleLinear().copy.toString(),se=a.scaleLog().copy.toString(),ue=a.scalePow().copy.toString(),ce=a.scaleTime().copy.toString(),be=a.scaleIdentity(),ge=Date.now(),he=function(e){return e-ge},ve=function(){var e=c(b),t=c(g);return e.appendHeader(x.header).appendBody(x.body),t.appendHeader(w.header).appendBody(w.body),{vertex:function(){return e},fragment:function(){return t}}},pe=function(){var e=c(b),t=c(g);return e.appendHeader(V.header).appendBody(V.body),t.appendHeader(k.header).appendBody(k.body),{vertex:function(){return e},fragment:function(){return t}}},ye=function(){var e=c(b),t=c(g);return e.appendHeader(C.header).appendBody(C.body),t.appendHeader(H.header).appendBody(H.body),{vertex:function(){return e},fragment:function(){return t}}},Se=function(){var e=c(b),t=c(g);return e.appendHeader(m.header).appendBody(m.body),t.appendHeader(Y.header).appendBody(Y.body),{vertex:function(){return e},fragment:function(){return t}}},xe=function(){var e=c(b),t=c(g);return e.appendHeader(y.header).appendBody(y.body),t.appendHeader(I.header).appendBody(I.body),{vertex:function(){return e},fragment:function(){return t}}},me=function(){var e=c(b),t=c(g);return e.appendHeader(S.header).appendBody(S.body),t.appendHeader(P.header).appendBody(P.body),{vertex:function(){return e},fragment:function(){return t}}},Ve=function(e){var a=Q().divisor(1),i=e,o=!0,r=function(e){if(a(e),!!o){if(!Array.isArray(i))throw new Error("Expected an array, received: ".concat(i));if(i.length!==a.size())throw new Error("Expected array of length: ".concat(a.size(),", recieved array of length: ").concat(i.length));var t=e.context();t["vertexAttrib".concat(i.length,"fv")](a.location(),i),t.disableVertexAttribArray(a.location()),o=!1}};return r.clear=function(){o=!0},r.value=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],o=!0,r):i},t.rebind(r,a,"normalized","size","location"),r};e.webglAdjacentAttribute=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(0<e||0>a)throw new Error("Offset values (".concat(e," & ").concat(a,") must straddle 0 "));var i=Q(),r=Z(),l=function t(l){var d=t.size()*o(t.type()),f=n(e)*d;if(i.offset(f).size(t.size()).type(t.type()),i(l),!!r.dirty()){var s=r(),u=f+s.length*o(t.type())+a*d,c=l.context();c.bindBuffer(c.ARRAY_BUFFER,i.buffer()),c.bufferData(c.ARRAY_BUFFER,u,c.DYNAMIC_DRAW),c.bufferSubData(c.ARRAY_BUFFER,f,s)}};return l.offset=function(r){if(e>r||r>a)throw new Error("Requested offset ".concat(r," exceeds bounds (").concat(e," & ").concat(a,") "));var n=function(t){i.offset((r-e)*l.size()*o(l.type())),i(t)};return t.rebind(n,l,"clear","location"),n},l.clear=function(){i.buffer(null),r.clear()},t.rebind(l,i,"normalized","location","divisor"),t.rebind(l,r,"data","value","size","type"),l},e.webglAttribute=j,e.webglBaseAttribute=Q,e.webglBufferBuilder=d,e.webglElementIndices=ee,e.webglFillColor=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[0,0,0,1],a=j().size(4),i=e,o=!0,r=function(e){if(e.vertexShader().appendHeaderIfNotExists(h.header).appendBodyIfNotExists(h.body),e.fragmentShader().appendHeaderIfNotExists(O.header).appendBodyIfNotExists(O.body),Array.isArray(i))e.buffers().attribute("aFillColor",Ve(i).size(4));else if("function"==typeof i){if(!o)return;a.value(i),e.buffers().attribute("aFillColor",a)}else throw new Error("Expected value to be an array or function, received ".concat(i));o=!1};return r.value=function(){return arguments.length?(i!==(0>=arguments.length?void 0:arguments[0])&&(i=0>=arguments.length?void 0:arguments[0],o=!0),r):i},t.rebind(r,a,"data"),r},e.webglProgramBuilder=u,e.webglScaleLinear=ne,e.webglScaleLog=le,e.webglScaleMapper=function(e){switch(e.copy.toString()){case fe:return{scale:be,webglScale:ne().domain(e.domain())};case ce:return{scale:he,webglScale:ne().domain(e.domain().map(he))};case se:return{scale:be,webglScale:le().domain(e.domain()).base(e.base())};case ue:return{scale:be,webglScale:de().domain(e.domain()).exponent(e.exponent())};default:return{scale:e.copy(),webglScale:ne().domain(e.range())};}},e.webglScalePow=de,e.webglSeriesArea=function(){var e=u().mode(s.TRIANGLES).subInstanceCount(6),a=l(),i=l(),o=function(){},r=j().divisor(0).size(3).type(X.UNSIGNED_BYTE).data([[0,0,0],[0,1,0],[1,1,1],[0,0,1],[1,0,0],[1,1,0]]);e.buffers().attribute("aCorner",r);var n=function(t){var r=U();e.vertexShader(r.vertex()).fragmentShader(r.fragment()),a(e,"gl_Position",0),i(e,"gl_Position",1),o(e),e(t-1)};return n.decorate=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],n):o},n.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],n):a},n.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],n):i},t.rebind(n,e,"context","pixelRatio"),K(n,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(n,"crossNextValueAttribute",e.buffers(),"attribute","aCrossNextValue"),K(n,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),K(n,"mainNextValueAttribute",e.buffers(),"attribute","aMainNextValue"),K(n,"baseValueAttribute",e.buffers(),"attribute","aBaseValue"),K(n,"baseNextValueAttribute",e.buffers(),"attribute","aBaseNextValue"),K(n,"definedAttribute",e.buffers(),"attribute","aDefined"),K(n,"definedNextAttribute",e.buffers(),"attribute","aDefinedNext"),n},e.webglSeriesBar=function(){var e=u().mode(s.TRIANGLES).subInstanceCount(6),a=l(),i=l(),o=function(){},r=j().divisor(0).size(2).type(X.BYTE).data([[-1,-1],[1,1],[-1,1],[1,-1]]);e.buffers().elementIndices(ee([0,1,2,0,1,3])).attribute("aCorner",r);var n=function(t){var r=ae();e.vertexShader(r.vertex()).fragmentShader(r.fragment()),a(e,"gl_Position",0),i(e,"gl_Position",1),e.vertexShader().appendBody("\n            gl_Position.x += xModifier / uScreen.x * 2.0;\n        "),o(e),e(t)};return n.decorate=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],n):o},n.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],n):a},n.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],n):i},t.rebind(n,e,"context","pixelRatio"),K(n,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(n,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),K(n,"baseValueAttribute",e.buffers(),"attribute","aBaseValue"),K(n,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),K(n,"definedAttribute",e.buffers(),"attribute","aDefined"),n},e.webglSeriesBoxPlot=function(){var e=u().mode(s.TRIANGLES).subInstanceCount(54),a=l(),i=l(),o=function(){},r=$(),n=j().divisor(0).size(4).type(X.BYTE).data([[-1,-2,-1,1],[1,-2,-1,1],[1,-2,1,1],[-1,-2,1,1],[0,-2,-1,0],[0,-2,1,0],[0,-1,1,0],[0,-1,-1,0],[-1,-1,-1,1],[1,-1,-1,1],[1,-1,1,1],[-1,-1,1,1],[-1,0,-1,1],[1,0,-1,1],[1,0,1,1],[-1,0,1,1],[-1,1,-1,1],[1,1,-1,1],[1,1,1,1],[-1,1,1,1],[-1,-1,-1,0],[-1,-1,1,0],[-1,1,1,0],[-1,1,-1,0],[1,-1,-1,0],[1,-1,1,0],[1,1,1,0],[1,1,-1,0],[0,2,-1,0],[0,2,1,0],[0,1,1,0],[0,1,-1,0],[-1,2,-1,1],[1,2,-1,1],[1,2,1,1],[-1,2,1,1]]);e.buffers().elementIndices(ee([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23,24,25,26,24,26,27,28,29,30,28,30,31,32,33,34,32,34,35])).attribute("aCorner",n);var d=function(t){var n=re();e.vertexShader(n.vertex()).fragmentShader(n.fragment()),a(e,"gl_Position",0),i(e,"gl_Position",1),r(e),e.vertexShader().appendBody("\n            gl_Position.x += xModifier / uScreen.x * 2.0;\n            gl_Position.y += yModifier / uScreen.y * 2.0;\n        "),o(e),e(t)};return d.decorate=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],d):o},d.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],d):a},d.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],d):i},t.rebind(d,e,"context","pixelRatio"),t.rebind(d,r,"lineWidth"),K(d,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(d,"highValueAttribute",e.buffers(),"attribute","aHighValue"),K(d,"upperQuartileValueAttribute",e.buffers(),"attribute","aUpperQuartileValue"),K(d,"medianValueAttribute",e.buffers(),"attribute","aMedianValue"),K(d,"lowerQuartileValueAttribute",e.buffers(),"attribute","aLowerQuartileValue"),K(d,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),K(d,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),K(d,"capAttribute",e.buffers(),"attribute","aCapWidth"),K(d,"definedAttribute",e.buffers(),"attribute","aDefined"),d},e.webglSeriesCandlestick=function(){var e=u().mode(s.TRIANGLES).subInstanceCount(12),a=l(),i=l(),o=$(),r=function(){},n=j().divisor(0).size(3).type(X.BYTE).data([[0,2,1],[0,2,-1],[0,-2,-1],[0,-2,1],[1,-1,0],[-1,-1,0],[-1,1,0],[1,1,0]]);e.buffers().elementIndices(ee([0,1,2,0,3,2,4,5,6,4,7,6])).attribute("aCorner",n);var d=function(t){var n=oe();e.vertexShader(n.vertex()).fragmentShader(n.fragment()),a(e,"gl_Position",0),i(e,"gl_Position",1),o(e),e.vertexShader().appendBody("\n          gl_Position.x += xModifier / uScreen.x * 2.0;\n          gl_Position.y += yModifier / uScreen.y * 2.0;\n        "),r(e),e(t)};return d.decorate=function(){return arguments.length?(r=0>=arguments.length?void 0:arguments[0],d):r},d.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],d):a},d.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],d):i},t.rebind(d,e,"context","pixelRatio"),t.rebind(d,o,"lineWidth"),K(d,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(d,"openValueAttribute",e.buffers(),"attribute","aOpenValue"),K(d,"highValueAttribute",e.buffers(),"attribute","aHighValue"),K(d,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),K(d,"closeValueAttribute",e.buffers(),"attribute","aCloseValue"),K(d,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),K(d,"definedAttribute",e.buffers(),"attribute","aDefined"),d},e.webglSeriesErrorBar=function(){var e=u().mode(s.TRIANGLES).subInstanceCount(18),a=l(),i=l(),o=function(){},r=$(),n=j().divisor(0).size(3).type(X.BYTE).data([[0,1,1],[0,1,-1],[0,-1,-1],[0,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1],[-1,-1,1],[-1,1,-1],[-1,1,1],[1,1,1],[1,1,-1]]);e.buffers().elementIndices(ee([0,1,2,0,3,2,4,5,6,4,7,6,8,9,10,8,11,10])).attribute("aCorner",n);var d=function(t){var n=ie();e.vertexShader(n.vertex()).fragmentShader(n.fragment()),a(e,"gl_Position",0),i(e,"gl_Position",1),r(e),e.vertexShader().appendBody("\n                gl_Position.x += xModifier / uScreen.x * 2.0;\n                gl_Position.y += yModifier / uScreen.y * 2.0;\n            "),o(e),e(t)};return d.decorate=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],d):o},d.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],d):a},d.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],d):i},t.rebind(d,e,"context","pixelRatio"),t.rebind(d,r,"lineWidth"),K(d,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(d,"highValueAttribute",e.buffers(),"attribute","aHighValue"),K(d,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),K(d,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),K(d,"definedAttribute",e.buffers(),"attribute","aDefined"),d},e.webglSeriesLine=function(){var e=u().mode(s.TRIANGLES).subInstanceCount(6),a=l(),i=l(),o=function(){},r=$(),n=j().divisor(0).size(4).type(X.BYTE).data([[-1,1,1,0],[1,1,0,1],[1,-1,0,1],[-1,-1,1,0]]);e.buffers().elementIndices(ee([0,1,2,2,3,0])).attribute("aCorner",n);var d=function(t){var n=c(b),l=c(g);e.vertexShader(n).fragmentShader(l),n.appendHeader("\n            attribute vec4 aCorner;\n            attribute float aCrossValue;\n            attribute float aCrossNextValue;\n            attribute float aMainValue;\n            attribute float aMainNextValue;\n            attribute float aDefined;\n            attribute float aDefinedNext;\n\n            uniform float uStrokeWidth;\n            uniform vec2 uScreen;\n\n            varying float vLength;\n            varying vec2 vPosition;\n        "),n.appendBody("\n            vec4 value = vec4(aCrossValue, aMainValue, 0.0, 1.0);\n            vec4 nextValue = vec4(aCrossNextValue, aMainNextValue, 0.0, 1.0);\n        "),a(e,"value",0),a(e,"nextValue",0),i(e,"value",1),i(e,"nextValue",1),n.appendBody("\n            vec2 position = aCorner[2] * value.xy + aCorner[3] * nextValue.xy;\n\n            vec2 direction = normalize((nextValue.xy - value.xy) * uScreen);\n            vec2 normal = vec2(direction.y, -direction.x);\n            vec2 padding = ((uStrokeWidth / 2.0) / (uScreen / 2.0));\n            \n            padding *= aDefined * aDefinedNext;\n            position += (aCorner[0] * direction + aCorner[1] * normal) * padding;\n\n            gl_Position = vec4(position.x, position.y, 0.0, 1.0);\n\n            vLength = length((nextValue.xy - value.xy) * (uScreen / 2.0));\n            vPosition = aCorner.xy * (uStrokeWidth / 2.0);\n            vPosition.x += aCorner[3] * vLength;\n        "),l.appendHeader("\n            uniform float uStrokeWidth;\n            varying float vLength;\n            varying vec2 vPosition;\n\n            float canFill = 0.0;\n            float canStroke = 1.0;\n        "),l.appendBody("\n            vec2 position = vPosition;\n            position.x -= clamp(position.x, 0.0, vLength);\n            float sdf = length(position) - uStrokeWidth / 2.0;\n            if (sdf > 0.5) {\n                discard;\n            }\n        "),r(e),o(e),e(t-1)};return d.decorate=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],d):o},d.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],d):a},d.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],d):i},t.rebind(d,e,"context","pixelRatio"),t.rebind(d,r,"lineWidth"),K(d,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(d,"crossNextValueAttribute",e.buffers(),"attribute","aCrossNextValue"),K(d,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),K(d,"mainNextValueAttribute",e.buffers(),"attribute","aMainNextValue"),K(d,"definedAttribute",e.buffers(),"attribute","aDefined"),K(d,"definedNextAttribute",e.buffers(),"attribute","aDefinedNext"),d},e.webglSeriesOhlc=function(){var e=u().mode(s.TRIANGLES).subInstanceCount(18),a=l(),i=l(),o=$(),r=function(){},n=j().divisor(0).size(3).type(X.BYTE).data([[0,-2,-1],[0,-2,1],[0,2,1],[0,2,-1],[-1,-1,-1],[-1,-1,1],[0,-1,1],[0,-1,-1],[1,1,1],[0,1,1],[0,1,-1],[1,1,-1]]);e.buffers().elementIndices(ee([0,1,2,0,3,2,4,5,6,4,7,6,8,9,10,10,11,8])).attribute("aCorner",n);var d=function(t){var n=te();e.vertexShader(n.vertex()).fragmentShader(n.fragment()),a(e,"gl_Position",0),i(e,"gl_Position",1),o(e),e.vertexShader().appendBody("\n          gl_Position.x += xModifier / uScreen.x * 2.0;\n          gl_Position.y += yModifier / uScreen.y * 2.0;\n        "),r(e),e(t)};return d.decorate=function(){return arguments.length?(r=0>=arguments.length?void 0:arguments[0],d):r},d.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],d):a},d.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],d):i},t.rebind(d,e,"context","pixelRatio"),t.rebind(d,o,"lineWidth"),K(d,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(d,"openValueAttribute",e.buffers(),"attribute","aOpenValue"),K(d,"highValueAttribute",e.buffers(),"attribute","aHighValue"),K(d,"lowValueAttribute",e.buffers(),"attribute","aLowValue"),K(d,"closeValueAttribute",e.buffers(),"attribute","aCloseValue"),K(d,"bandwidthAttribute",e.buffers(),"attribute","aBandwidth"),K(d,"definedAttribute",e.buffers(),"attribute","aDefined"),d},e.webglSeriesPoint=function(){var e=u().mode(s.POINTS),a=l(),i=l(),o=J(),r=function(){},n=function(t){e.vertexShader(o.vertex()).fragmentShader(o.fragment()),a(e,"gl_Position",0),i(e,"gl_Position",1),r(e),e(t)};return n.type=function(){return arguments.length?(o=0>=arguments.length?void 0:arguments[0],n):o},n.decorate=function(){return arguments.length?(r=0>=arguments.length?void 0:arguments[0],n):r},n.xScale=function(){return arguments.length?(a=0>=arguments.length?void 0:arguments[0],n):a},n.yScale=function(){return arguments.length?(i=0>=arguments.length?void 0:arguments[0],n):i},t.rebind(n,e,"context","pixelRatio"),K(n,"crossValueAttribute",e.buffers(),"attribute","aCrossValue"),K(n,"mainValueAttribute",e.buffers(),"attribute","aMainValue"),K(n,"sizeAttribute",e.buffers(),"attribute","aSize"),K(n,"definedAttribute",e.buffers(),"attribute","aDefined"),n},e.webglShaderBuilder=c,e.webglStrokeColor=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[0,0,0,1],a=j().size(4),i=e,o=!0,r=function(e){if(e.vertexShader().appendHeaderIfNotExists(v.header).appendBodyIfNotExists(v.body),e.fragmentShader().appendHeaderIfNotExists(G.header).appendBodyIfNotExists(G.body),Array.isArray(i))e.buffers().attribute("aStrokeColor",Ve(i).size(4));else if("function"==typeof i){if(!o)return;a.value(i),e.buffers().attribute("aStrokeColor",a)}else throw new Error("Expected value to be an array or function, received ".concat(i));o=!1};return r.value=function(){return arguments.length?(i!==(0>=arguments.length?void 0:arguments[0])&&(i=0>=arguments.length?void 0:arguments[0],o=!0),r):i},t.rebind(r,a,"data"),r},e.webglSymbolMapper=function(e){switch(e){case i.symbolCircle:return J();case i.symbolSquare:return ve();case i.symbolTriangle:return pe();case i.symbolCross:return ye();case i.symbolDiamond:return Se();case i.symbolStar:return xe();case i.symbolWye:return me();default:throw new Error("Unrecognised symbol: ".concat(e));}},e.webglTypes=X,e.webglUniform=f,Object.defineProperty(e,"__esModule",{value:!0})});
